!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.eventshandler=t():e.eventshandler=t()}(this,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.r(t),e.d(t,{Ctrlz:()=>c,Eventbus:()=>o,EventsHandler:()=>l});var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{command:"default",behave:function(e,t){return console.log("Not aware of: "+JSON.stringify(e)),t}};n(this,e),this.handlers=new Map,this.handlers.set(t.command,t.behave)}var t,a;return t=e,(a=[{key:"accept",value:function(e,t){try{var n=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e));return void 0===this.handlers.get(e.command)?this.handlers.get("default").call(this,r,n):this.handlers.get(e.command).behave(r,n)}catch(e){return JSON.parse(JSON.stringify(n))}}}])&&r(t.prototype,a),e}();const o=a;function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=arguments.length>1?arguments[1]:void 0;i(this,e),this.queueMaxSize=t,this.queue=[],this.state={},this.stateHandler=n}var t,n;return t=e,(n=[{key:"accept",value:function(e,t){this.queue.length<1?this.state=t:this.queue.length>=this.queueMaxSize&&(this.state=this.updateStateAndQueue(this.queue,this.state,this.stateHandler)),this.queue.push(e)}},{key:"updateStateAndQueue",value:function(e,t,n){var r=e[0];return e.shift(),null==n?t:n.accept(r,t)}}])&&u(t.prototype,n),e}();const c=s;function l(e,t){e.handlers.set("ctrlz",{behave:function(n,r){var a,o;a=t.queue,o=n.howmany||1,a.splice(a.length-o,a.length-1);var i=JSON.parse(JSON.stringify(t.state));return t.queue.forEach((function(t){i=e.accept(t,i)})),i}});var n={accept:function(n,r){var a=e.accept(n,r);return t.accept(n,r),a}};return n.eventbus=e,n.ctrlz=t,n}return t})()}));